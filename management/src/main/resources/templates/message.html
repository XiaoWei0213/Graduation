<!DOCTYPE html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>消息通知</title>
	
	<link rel="icon" th:href="@{/img/icon.ico}" type="image/x-icon"/>

	<!-- Fonts and icons -->
	<script th:src="@{/js/plugin/webfont/webfont.min.js}"></script>
	<script th:inline="javascript">
		WebFont.load({
			google: {"families":["Open+Sans:300,400,600,700"]},
			custom: {"families":["Flaticon", "Font Awesome 5 Solid", "Font Awesome 5 Regular", "Font Awesome 5 Brands"], urls: ['/css/fonts.css']},
			active: function() {
				sessionStorage.fonts = true;
			}
		});
	</script>
	<!-- CSS Files -->
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/css/azzara.min.css}">

</head>
<body>
	<div class="wrapper">
		<!--
			Tip 1: You can change the background color of the main header using: data-background-color="blue | purple | light-blue | green | orange | red"
		-->
		<div class="main-header" data-background-color="blue" th:replace="head::common_head">
		</div>

		<!-- Sidebar -->
		<div class="sidebar">
			
			<div class="sidebar-background"></div>
			<div class="sidebar-wrapper scrollbar-inner">
				<div class="sidebar-content">
					<ul class="nav">
						<li class="nav-item">
							<a th:href="@{/index}">
								<i class="fas fa-home"></i>
								<p>首页</p>
							</a>
						</li>
                       <li class="nav-item">
                           <a data-toggle="collapse" href="#waste">
                               <i class="fas fa-layer-group"></i>
                               <p>废物管理</p>
                               <span class="caret"></span>
                           </a>
                           <div class="collapse" id="waste">
                               <ul class="nav nav-collapse">
                                   <li>
                                       <a th:href="@{/code}">
                                           <span class="sub-item">条码管理</span>
                                       </a>
                                   </li>
                                   <li>
                                       <a th:href="@{/operate}">
                                           <span class="sub-item">流程操作</span>
                                       </a>
                                   </li>
                               </ul>
                           </div>
                       </li>
                       <li class="nav-item">
                           <a data-toggle="collapse" href="#machine">
                               <i class="fas fa-pen-square"></i>
                               <p>机器管理</p>
                               <span class="caret"></span>
                           </a>
                           <div class="collapse" id="machine">
                               <ul class="nav nav-collapse">
                                   <li>
                                       <a th:href="@{/machine}">
                                           <span class="sub-item">机器列表</span>
                                       </a>
                                   </li>
                               </ul>
                           </div>
                       </li>
                       <li class="nav-item">
                           <a data-toggle="collapse" href="#count">
                               <i class="fas fa-table"></i>
                               <p>统计分析</p>
                               <span class="caret"></span>
                           </a>
                           <div class="collapse" id="count">
                               <ul class="nav nav-collapse">
                                   <li>
                                       <a th:href="@{/search}">
                                           <span class="sub-item">收集统计</span>
                                       </a>
                                   </li>
                                   <li>
                                       <a th:href="@{/count}">
                                           <span class="sub-item">收集查询</span>
                                       </a>
                                   </li>
                               </ul>
                           </div>
                       </li>
                        <li class="nav-item" th:if="${session.account.role == 'M'}">
                            <a data-toggle="collapse" href="#person">
                                <i class="fas fa-user-friends"></i>
                                <p>人员管理</p>
                                <span class="caret"></span>
                            </a>
                            <div class="collapse" id="person">
                                <ul class="nav nav-collapse">
                                    <li>
                                        <a th:href="@{/person}">
                                            <span class="sub-item">人员列表</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                       <li class="nav-item active">
                           <a data-toggle="collapse" href="#user">
                               <i class="fas fa-desktop"></i>
                               <p>用户管理</p>
                               <span class="caret"></span>
                           </a>
                           <div class="collapse show" id="user">
                               <ul class="nav nav-collapse">
                                   <li  class="active">
                                       <a th:href="@{/message}">
                                           <span class="sub-item">消息通知</span>
                                       </a>
                                   </li>
                                    <li>
                                        <a th:href="@{/user}">
                                            <span class="sub-item">信息管理</span>
                                        </a>
                                    </li>
                               </ul>
                           </div>
                       </li>
					</ul>
				</div>
			</div>
		</div>
		<!-- End Sidebar -->

		<div class="main-panel">
			<div class="content">
				<div class="page-inner">
					<div class="row">
						<div class="col-md-12">
							<div class="card card-with-nav">
							    <div class="card-header">
									<div class="row row-nav-line">
										<ul class="nav nav-tabs nav-line nav-color-secondary" role="tablist">
											<li class="nav-item"> <a class="nav-link active show" data-toggle="tab">消息列表</a> </li>
											<li class="nav-item"> <a class="nav-link" data-toggle="tab">同事列表</a> </li>
										</ul>
									</div>
                               </div>
								<div class="card-body">
								     <div>
                                         <div class="clo-md-12" th:each="message:${pagination.data}">
                                            <div class="d-flex">
                                                <div class="avatar">
                                                    <span class="avatar-title rounded-circle border border-white bg-info"><i class="fas fa-envelope"></i></span>
                                                </div>
                                                <div class="flex-1 ml-3 pt-1">
                                                    <h5 class="text-uppercase fw-bold mb-1" >
                                                       <a  href="javascript:void(0);" th:onclick="Display([[${message}]])" th:text="${message.title}"></a>
                                                       <span class="pl-3" th:if="${message.send != 'system'}" th:text="${message.send}">发件人</span>
                                                       <span th:text="${message.state}" th:class="${message.state == '已读'}? 'text-success pl-3' : 'text-warning pl-3'">未读</span>
                                                    </h5>
                                                    <span class="text-muted" th:text="${message.content}">I am facing some trouble with my viewport. When i start my</span>
                                                </div>
                                                <div class="float-right pt-1">
                                                    <small class="text-muted" th:text="${message.date}">8:40 PM</small>
                                                    <a class="pl-3" href="javascript:void(0);" th:onclick="DeleteMessage([[${message.id}]])">删除</a>
                                                    <a class="pl-3" href="javascript:void(0);" th:if="${message.state == '未读'}"  th:onclick="MarkRead([[${message.id}]],[[${message.state}]])">标记已读</a>
                                                </div>
                                            </div>
                                            <div class="separator-dashed"></div>
                                        </div>
                                        <div class="demo">
                                            <ul class="pagination pg-primary">
                                                <li class="page-item" th:if="${pagination.showPrevious}">
                                                    <a class="page-link" th:href="@{/message(page=${pagination.page - 1})}" aria-label="Previous">
                                                        <span aria-hidden="true">&laquo;</span>
                                                        <span class="sr-only">Previous</span>
                                                    </a>
                                                </li>
                                                <li class="page-item" th:each="page : ${pagination.pages}" th:class="${pagination.page == page}? 'active' : ''">
                                                    <a class="page-link" th:href="@{/message(page=${page})}" th:text="${page}">1</a>
                                                </li>
                                                <li class="page-item" th:if="${pagination.showNext}">
                                                    <a class="page-link" th:href="@{/message(page=${pagination.page +1 })}" aria-label="Next">
                                                        <span aria-hidden="true">&raquo;</span>
                                                        <span class="sr-only">Next</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div style="display: none">
                                         <div class="clo-md-12" id="colleagues" th:fragment="colleagues" th:each="col:${colleagues.data}">
                                               <div class="d-flex">
                                                   <div class="avatar">
                                                       <span class="avatar-title rounded-circle border border-white bg-info"><i class="fas fa-user"></i></span>
                                                   </div>
                                                   <div class="flex-1 ml-3 pt-1">
                                                       <h5 class="text-uppercase fw-bold mb-1" >
                                                          <a  href="javascript:void(0);"></a>
                                                          <span th:text="${col.username}">姓名</span>
                                                       </h5>
                                                       <span class="text-muted" th:text="${col.useraddress}">角色</span>
                                                   </div>
                                                   <div class="float-right pt-1">
                                                       <a class="pl-3" th:onclick="viewInfo('[[${col}]]')">详细信息</a>
                                                       <a class="pl-3" th:onclick="sendMsg([[${col.accountid}]],[[${selfId}]])">发消息</a>
                                                   </div>
                                               </div>
                                               <div class="separator-dashed"></div>
                                         </div>
                                         <div class="demo">
                                            <ul class="pagination pg-primary">
                                                <li class="page-item" th:if="${colleagues.showPrevious}">
                                                    <a class="page-link" aria-label="Previous" th:onclick="colleagueLoad('[[${colleagues.page-1}]]')">
                                                        <span aria-hidden="true">&laquo;</span>
                                                        <span class="sr-only">Previous</span>
                                                    </a>
                                                </li>
                                                <li class="page-item" th:each="page : ${colleagues.pages}" th:class="${colleagues.page == page}? 'active' : ''">
                                                    <a class="page-link" th:text="${page}" th:onclick="colleagueLoad('[[${page}]]')">1</a>
                                                </li>
                                                <li class="page-item" th:if="${colleagues.showNext}">
                                                    <a class="page-link" aria-label="Next" th:onclick="colleagueLoad('[[${colleagues.page+1}]]')">
                                                        <span aria-hidden="true">&raquo;</span>
                                                        <span class="sr-only">Next</span>
                                                    </a>
                                                </li>
                                            </ul>
                                         </div>
                                    </div>
                               </div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

<!-- Layer -->
<script th:src="@{/js/plugin/layer/layer.js}"></script>

<script th:src="@{/js/message.js}"></script>

</body>
</html>